{"ast":null,"code":"import { errorMonitor } from 'events';\nimport { types } from 'util';\nimport deferToConnect from 'defer-to-connect';\nconst timer = request => {\n  if (request.timings) {\n    return request.timings;\n  }\n  const timings = {\n    start: Date.now(),\n    socket: undefined,\n    lookup: undefined,\n    connect: undefined,\n    secureConnect: undefined,\n    upload: undefined,\n    response: undefined,\n    end: undefined,\n    error: undefined,\n    abort: undefined,\n    phases: {\n      wait: undefined,\n      dns: undefined,\n      tcp: undefined,\n      tls: undefined,\n      request: undefined,\n      firstByte: undefined,\n      download: undefined,\n      total: undefined\n    }\n  };\n  request.timings = timings;\n  const handleError = origin => {\n    origin.once(errorMonitor, () => {\n      timings.error = Date.now();\n      timings.phases.total = timings.error - timings.start;\n    });\n  };\n  handleError(request);\n  const onAbort = () => {\n    timings.abort = Date.now();\n    timings.phases.total = timings.abort - timings.start;\n  };\n  request.prependOnceListener('abort', onAbort);\n  const onSocket = socket => {\n    timings.socket = Date.now();\n    timings.phases.wait = timings.socket - timings.start;\n    if (types.isProxy(socket)) {\n      return;\n    }\n    const lookupListener = () => {\n      timings.lookup = Date.now();\n      timings.phases.dns = timings.lookup - timings.socket;\n    };\n    socket.prependOnceListener('lookup', lookupListener);\n    deferToConnect(socket, {\n      connect: () => {\n        timings.connect = Date.now();\n        if (timings.lookup === undefined) {\n          socket.removeListener('lookup', lookupListener);\n          timings.lookup = timings.connect;\n          timings.phases.dns = timings.lookup - timings.socket;\n        }\n        timings.phases.tcp = timings.connect - timings.lookup;\n      },\n      secureConnect: () => {\n        timings.secureConnect = Date.now();\n        timings.phases.tls = timings.secureConnect - timings.connect;\n      }\n    });\n  };\n  if (request.socket) {\n    onSocket(request.socket);\n  } else {\n    request.prependOnceListener('socket', onSocket);\n  }\n  const onUpload = () => {\n    timings.upload = Date.now();\n    timings.phases.request = timings.upload - (timings.secureConnect ?? timings.connect);\n  };\n  if (request.writableFinished) {\n    onUpload();\n  } else {\n    request.prependOnceListener('finish', onUpload);\n  }\n  request.prependOnceListener('response', response => {\n    timings.response = Date.now();\n    timings.phases.firstByte = timings.response - timings.upload;\n    response.timings = timings;\n    handleError(response);\n    response.prependOnceListener('end', () => {\n      request.off('abort', onAbort);\n      response.off('aborted', onAbort);\n      if (timings.phases.total) {\n        // Aborted or errored\n        return;\n      }\n      timings.end = Date.now();\n      timings.phases.download = timings.end - timings.response;\n      timings.phases.total = timings.end - timings.start;\n    });\n    response.prependOnceListener('aborted', onAbort);\n  });\n  return timings;\n};\nexport default timer;","map":{"version":3,"names":["errorMonitor","types","deferToConnect","timer","request","timings","start","Date","now","socket","undefined","lookup","connect","secureConnect","upload","response","end","error","abort","phases","wait","dns","tcp","tls","firstByte","download","total","handleError","origin","once","onAbort","prependOnceListener","onSocket","isProxy","lookupListener","removeListener","onUpload","writableFinished","off"],"sources":["D:/LangChainJS/chatpdf/node_modules/@szmarczak/http-timer/dist/source/index.js"],"sourcesContent":["import { errorMonitor } from 'events';\nimport { types } from 'util';\nimport deferToConnect from 'defer-to-connect';\nconst timer = (request) => {\n    if (request.timings) {\n        return request.timings;\n    }\n    const timings = {\n        start: Date.now(),\n        socket: undefined,\n        lookup: undefined,\n        connect: undefined,\n        secureConnect: undefined,\n        upload: undefined,\n        response: undefined,\n        end: undefined,\n        error: undefined,\n        abort: undefined,\n        phases: {\n            wait: undefined,\n            dns: undefined,\n            tcp: undefined,\n            tls: undefined,\n            request: undefined,\n            firstByte: undefined,\n            download: undefined,\n            total: undefined,\n        },\n    };\n    request.timings = timings;\n    const handleError = (origin) => {\n        origin.once(errorMonitor, () => {\n            timings.error = Date.now();\n            timings.phases.total = timings.error - timings.start;\n        });\n    };\n    handleError(request);\n    const onAbort = () => {\n        timings.abort = Date.now();\n        timings.phases.total = timings.abort - timings.start;\n    };\n    request.prependOnceListener('abort', onAbort);\n    const onSocket = (socket) => {\n        timings.socket = Date.now();\n        timings.phases.wait = timings.socket - timings.start;\n        if (types.isProxy(socket)) {\n            return;\n        }\n        const lookupListener = () => {\n            timings.lookup = Date.now();\n            timings.phases.dns = timings.lookup - timings.socket;\n        };\n        socket.prependOnceListener('lookup', lookupListener);\n        deferToConnect(socket, {\n            connect: () => {\n                timings.connect = Date.now();\n                if (timings.lookup === undefined) {\n                    socket.removeListener('lookup', lookupListener);\n                    timings.lookup = timings.connect;\n                    timings.phases.dns = timings.lookup - timings.socket;\n                }\n                timings.phases.tcp = timings.connect - timings.lookup;\n            },\n            secureConnect: () => {\n                timings.secureConnect = Date.now();\n                timings.phases.tls = timings.secureConnect - timings.connect;\n            },\n        });\n    };\n    if (request.socket) {\n        onSocket(request.socket);\n    }\n    else {\n        request.prependOnceListener('socket', onSocket);\n    }\n    const onUpload = () => {\n        timings.upload = Date.now();\n        timings.phases.request = timings.upload - (timings.secureConnect ?? timings.connect);\n    };\n    if (request.writableFinished) {\n        onUpload();\n    }\n    else {\n        request.prependOnceListener('finish', onUpload);\n    }\n    request.prependOnceListener('response', (response) => {\n        timings.response = Date.now();\n        timings.phases.firstByte = timings.response - timings.upload;\n        response.timings = timings;\n        handleError(response);\n        response.prependOnceListener('end', () => {\n            request.off('abort', onAbort);\n            response.off('aborted', onAbort);\n            if (timings.phases.total) {\n                // Aborted or errored\n                return;\n            }\n            timings.end = Date.now();\n            timings.phases.download = timings.end - timings.response;\n            timings.phases.total = timings.end - timings.start;\n        });\n        response.prependOnceListener('aborted', onAbort);\n    });\n    return timings;\n};\nexport default timer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}